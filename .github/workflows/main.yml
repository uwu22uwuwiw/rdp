name: Setup ngrok and Remote Desktop

on:
  workflow_dispatch:

  jobs:
    setup-ngrok:
        runs-on: windows-latest
            timeout-minutes: 360
                steps:
                      - name: Checkout repository
                              uses: actions/checkout@v3

                                    - name: Download ngrok
                                            shell: powershell
                                                    run: |
                                                              Invoke-WebRequest https://bin.equinox.io/c/bNyj1mQVY4c/ngrok-v3-stable-windows-amd64.zip -OutFile ngrok.zip
                                                                        Expand-Archive ngrok.zip -DestinationPath .
                                                                                  if (!(Test-Path -Path .\ngrok.exe)) { throw "Ngrok extraction failed" }

                                                                                        l
                                                                                              Add ngrok to PATH
                                                                                                      shell:";$PWD"
                                                                                                                echo "k
                                                                                                                rok path added"
                                                                                                                
                                                                                                                      - name:    run: .\ng ngrok
                                                                                                                              shell: powerK_AUTH_TOKEN
                                                                                                                                      env:
                                                                                                                                                NGROK_AUTH_TOKEN: ${e Remote Desktop
                                                                                                                                                  H_TOK shell: powershell
                                                                                                                                                          run: |
                                                                                                                                                              ktntrolSet\Control\Terminal Server" System"fDenyTSConnectisplayGroup "Remote Desktop"
                                                                                                                                                                        nelocalgroup eradmistrators runneradmin /add
                                                                                                                                                                        
                                                                                                                                                                            hell
                                                                                                                                                                                    run: |
                                                                                                                                                                                              Start-Job { .\ngrok.exe tcp 3389 }
                                                                                                                                                                                                     Ngrok tt-Sleep -Seconds 5
                                                                                                                                                                                                           name: Keep workfloNgrok e
                                                                                                                                                                                                                 -Output "Keeping the wo     run:e-Outp"
                                                                                                                                                                                                                           while ($true) {
                                                                                                                                                                                                                                       Write-Outp"
                                                                                                                                                                                                                                                 while ($true) {
                                                                                                                                                                                                                                                             Write-Outp"
                                                                                                                                                                                                                                                                       while ($true) {
                                                                                                                                                                                                                                                                                   Write-Outp"
                                                                                                                                                                                                                                                                                      -Seconds 300
                                                                                                                                                                                                                                                                                                }
                                                                                                                                                                                                                                                                                                        continue-on-error: trueds 300
                                                                                                                                                                                                                                                                                                                  }
                                                                                                                                                                                                                                                                                                                          continue-on-error: trueds 300
                                                                                                                                                                                                                                                                                                                                    }
                                                                                                                                                                                                                                                                                                                                            continue-on-error: trueds 300
                                                                                                                                                                                                                                                                                                                                                      }
                                                                                                                                                                                                                                                                                                                                                              continue-on-error: trueds 300
                                                                                                                                                                                                                                                                                                                                                                        }
                                                                                                                                                                                                                                                                                                                                                                                continue-on-error: trueds 300
                                                                                                                                                                                                                                                                                                                                                                                          }
                                                                                                                                                                                                                                                                                                                                                                                                  continue-on-error: trueds 300
                                                                                                                                                                                                                                                                                                                                                                                                            }
                                                                                                                                                                                                                                                                                                                                                                                                                    continue-on-error: trueds 300
                                                                                                                                                                                                                                                                                                                                                                                                                              }
                                                                                                                                                                                                                                                                                                                                                                                                                                      continue-on-error: trueds 300
                                                                                                                                                                                                                                                                                                                                                                                                                                                }
                                                                                                                                                                                                                                                                                                                                                                                                                                                        continue-on-error: true
